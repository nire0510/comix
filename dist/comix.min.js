(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.comix=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],2:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],3:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode")},{"./decode":1,"./encode":2}],4:[function(require,module,exports){module.exports={mixpanel_init:["cookie_expiration","cross_subdomain_cookie","disable_persistence","persistence","persistence_name","secure_cookie","track_links_timeout","upgrade"],defaults:{token:"",additional_properties:{},attribute:"data-comix",track_pageview:false,track_links:false,track_forms:false,track_custom:false},dictionary:{trackEventName:"Track",trackEventFailed:"Comix track miss",missingToken:"Mixpanel token is required",missingEventName:"(Event Missing)",pageNamePropertyName:"Page Name",pageURLPropertyName:"Page URL",pageViewedEventName:"Page Viewed"}}},{}],5:[function(require,module,exports){module.exports={findParentNode:function findParentNode(elmTarget,strNodeName){while(elmTarget.parentNode.nodeName!==strNodeName){elmTarget=elmTarget.parentNode}return elmTarget},extend:function extend(defaults,options){var objExtended={},objProperty;for(objProperty in defaults){if(Object.prototype.hasOwnProperty.call(defaults,objProperty)){objExtended[objProperty]=defaults[objProperty]}}for(objProperty in options){if(Object.prototype.hasOwnProperty.call(options,objProperty)){objExtended[objProperty]=options[objProperty]}}return objExtended}}},{}],6:[function(require,module,exports){var config=require("./config.js"),decode=require("querystring").decode,helpers=require("./helpers.js"),mp=require("./mixpanel.js"),mpTracking=require("./mixpanel-tracking.js"),mpPeople=require("./mixpanel-people.js"),objSettings=config.defaults;module.exports={init:init,track:mpTracking.trackEvent,trackEvent:mpTracking.trackEvent,trackCharge:mpTracking.trackCharge,disableEvents:mpTracking.disableEvents,registerEventsProperties:mpTracking.registerEventsProperties,unregisterEventsProperties:mpTracking.unregisterEventsProperties,identifyUser:mpPeople.identifyUser,registerUserProperties:mpTracking.registerUserProperties};function init(objParams){var objInitProperties={};for(var key in objSettings){if(objSettings.hasOwnProperty(key)&&objParams.hasOwnProperty(key)){objSettings[key]=objParams[key]}}if(objSettings.token===""){throw new Error(config.dictionary.missingToken)}config.mixpanel_init.forEach(function initProperties(key){if(objSettings.hasOwnProperty(key)){objInitProperties[key]=objSettings[key]}});objInitProperties.track_pageview=false;objInitProperties.loaded=_ready;mp.init(objParams.token,objInitProperties)}function _ready(){var arrRegisteredEvents=[];Element.prototype.matches=Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector;if(this===window){mpTracking.registerEventProperties(helpers.extend(decode(document.location.search&&document.location.search.substr(1))||{},objSettings.additional_properties))}if(objSettings.track_pageview){mpTracking.trackPageView()}if(objSettings.track_links){[].forEach.call(document.querySelectorAll("a[href][id]["+objSettings.attribute+"]"),function each(element){mpTracking.trackLink("#"+element.id,element.getAttribute(objSettings.attribute))})}if(objSettings.track_forms){[].forEach.call(document.querySelectorAll("form[id]["+objSettings.attribute+"]"),function each(element){mpTracking.trackForm("#"+element.id,element.getAttribute(objSettings.attribute))})}if(objSettings.track_custom&&Object.prototype.toString.call(objSettings.track_custom)==="[object Array]"&&objSettings.track_custom.length>0){objSettings.track_custom.forEach(function loop(item){if(arrRegisteredEvents.indexOf(item.event)===-1){arrRegisteredEvents.push(item.event);document.addEventListener(item.event,function(e){var element=e.target,strEventName;if(element.matches(item.selector)===true){e.preventDefault();try{switch(item.name.type){case"attribute":if(element.hasAttribute(item.name.value)===true){strEventName=element.getAttribute(item.name.value)}break;case"function":if(item.name.value&&typeof item.name.value==="function"){strEventName=item.name.value(element)}break;case"text":if(item.name.value){strEventName=item.name.value}break}if(strEventName){mpTracking.trackEvent(strEventName,{},function(){if(element.tagName==="A"){var strHref=element.getAttribute("href"),strTarget=element.getAttribute("target");strHref&&strHref.length>0&&(strTarget?window.open(strHref,strTarget):document.location.href=strHref)}else if(element.getAttribute("type")==="submit"){helpers.findParentNode(element,"FORM").submit()}})}}catch(e){console.warn(config.dictionary.trackEventFailed)}}},false)}})}}},{"./config.js":4,"./helpers.js":5,"./mixpanel-people.js":7,"./mixpanel-tracking.js":8,"./mixpanel.js":9,querystring:3}],7:[function(require,module,exports){module.exports={identifyUser:identifyUser,registerUserProperties:registerUserProperties};function identifyUser(strIdentity){mixpanel.identify(strIdentity)}function registerUserProperties(varProperty,varValue,fncCallback){mixpanel.people.set(varProperty,varValue,fncCallback)}},{}],8:[function(require,module,exports){var config=require("./config.js");module.exports={disableEvents:disableEvents,trackEvent:trackEvent,trackPageView:trackPageView,trackLink:trackLink,trackForm:trackForm,trackCharge:trackCharge,registerEventsProperties:registerEventsProperties,unregisterEventsProperties:unregisterEventsProperties};function disableEvents(arrEventNames){mixpanel.disable(arrEventNames)}function trackEvent(strEventName,objProperties,fncCallback){mixpanel.track(strEventName||config.dictionary.missingEventName,objProperties||{},fncCallback)}function trackPageView(objProperties){if(this===window){objProperties=objProperties||{};objProperties[config.dictionary.pageNamePropertyName]=document.title;objProperties[config.dictionary.pageURLPropertyName]=window.location.pathname;this.track(config.dictionary.pageViewedEventName,objProperties)}}function trackLink(strSelector,strEventName,objProperties){mixpanel.track_links(strSelector,strEventName,objProperties)}function trackForm(strSelector,strEventName,objProperties){mixpanel.track_forms(strSelector,strEventName,objProperties)}function trackCharge(fltAmount,objProperties,fncCallback){mixpanel.people.track_charge(fltAmount,objProperties,fncCallback)}function registerEventsProperties(objProperties,intDays){mixpanel.register(objProperties,intDays)}function unregisterEventsProperties(strProperty){mixpanel.unregister(strProperty)}},{"./config.js":4}],9:[function(require,module,exports){module.exports={init:init};function init(strToken,objInitProperties){(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);mixpanel.init(strToken,objInitProperties)}},{}]},{},[6])(6)});
